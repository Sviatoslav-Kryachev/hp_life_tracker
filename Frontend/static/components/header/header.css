/* ============= HEADER COMPONENT STYLES ============= */

/* Header container */
.fixed.top-0 {
    z-index: 9999 !important;
    width: 100% !important;
    left: 0 !important;
    right: 0 !important;
    display: flex !important;
    justify-content: center !important;
}

/* Header container - ограничиваем ширину как у основного контента */
.fixed.top-0 > .container {
    width: 100% !important;
    max-width: 72rem !important; /* max-w-6xl = 72rem = 1152px */
    margin-left: auto !important;
    margin-right: auto !important;
    box-sizing: border-box !important;
}

/* Flex контейнер внутри хедера */
.fixed.top-0 > .container > div.flex {
    flex-wrap: wrap !important;
    gap: 0.5rem !important;
    align-items: center !important;
}

/* Левый блок (лого + навигация) */
.fixed.top-0 > .container > div.flex > div:first-child {
    flex: 1 1 auto !important;
    min-width: 0 !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    overflow: hidden !important;
}

/* Правый блок (язык + XP + пользователь) */
.fixed.top-0 > .container > div.flex > div:last-child {
    flex: 0 0 auto !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    flex-wrap: nowrap !important;
}

/* Языковый переключатель */
#language-switcher-wrapper {
    position: relative !important;
    z-index: 10000 !important;
    overflow: visible !important;
}

/* Убеждаемся, что на мобильных кнопка кликабельна */
#language-switcher-btn {
    position: relative !important;
    z-index: 10001 !important;
    cursor: pointer !important;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1) !important;
    touch-action: manipulation !important;
}

#language-switcher-btn {
    white-space: nowrap !important;
    overflow: hidden !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

/* Дропдаун меню языка */
#language-menu {
    position: absolute !important;
    top: 100% !important;
    right: 0 !important;
    margin-top: 0.5rem !important;
    z-index: 10001 !important;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
    min-width: 10rem !important;
    width: max-content !important;
}

#language-menu.hidden {
    display: none !important;
}

#language-menu:not(.hidden) {
    display: block !important;
}

@keyframes fadeInDropdown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* XP бейдж - компактный на мобильных */
@media (max-width: 768px) {
    #wallet {
        flex-shrink: 0 !important;
        min-width: 4rem !important;
        padding: 0.25rem 0.5rem !important;
    }
}

/* Информация о пользователе - скрываем на мобильных */
@media (max-width: 768px) {
    #user-info {
        display: none !important;
    }
    
    .fixed.top-0 .bg-gray-50.border.border-gray-200.rounded-xl {
        padding: 0.25rem !important;
        gap: 0.25rem !important;
        flex-shrink: 0 !important;
    }
}

/* Адаптивный хедер для мобильных */
@media (max-width: 767px) {
    @supports (padding: env(safe-area-inset-top)) {
        .fixed.top-0 {
            padding-top: env(safe-area-inset-top) !important;
            padding-left: env(safe-area-inset-left) !important;
            padding-right: env(safe-area-inset-right) !important;
        }
        
        .fixed.top-0 > .container {
            padding-top: 0.5rem !important;
            padding-bottom: 0.5rem !important;
        }
    }
    
    @supports not (padding: env(safe-area-inset-top)) {
        .fixed.top-0 > .container {
            padding-top: 0.5rem !important;
            padding-bottom: 0.5rem !important;
        }
    }
    
    /* На мобильных скрываем навигационное меню */
    /* Это правило применяется только на экранах до 767px */
    .fixed.top-0 nav.hidden.md\:flex,
    .fixed.top-0 > .container > div.flex > div:first-child > nav.hidden.md\:flex {
        display: none !important;
        visibility: hidden !important;
    }
    
    .fixed.top-0 img.h-8.w-8.md\:h-10.md\:w-10 {
        height: 1.5rem !important;
        width: 1.5rem !important;
    }
    
    .fixed.top-0 h1.text-xl.md\:text-2xl {
        font-size: 1rem !important;
    }
    
    .fixed.top-0 #language-menu {
        top: calc(100% + 0.5rem) !important;
        right: 0 !important;
        z-index: 10002 !important;
        max-height: 60vh !important;
        overflow-y: auto !important;
        position: fixed !important;
        transform: translateX(0) !important;
        display: block !important;
    }
    
    /* Убеждаемся, что меню не обрезается на мобильных */
    #language-switcher-wrapper {
        overflow: visible !important;
        position: relative !important;
        z-index: 10001 !important;
    }
    
    /* Улучшаем кликабельность на мобильных */
    #language-switcher-btn {
        min-width: 2.5rem !important;
        min-height: 2.5rem !important;
        padding: 0.5rem !important;
        touch-action: manipulation !important;
        -webkit-tap-highlight-color: transparent !important;
    }
    
    /* Убеждаемся, что меню видимо на мобильных */
    #language-menu:not(.hidden) {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
}

/* Десктоп (от 768px) - показываем навигацию */
/* Это правило должно быть после всех правил для мобильных, чтобы иметь приоритет */
@media (min-width: 768px) {
    /* КРИТИЧНО: Переопределяем класс hidden для навигации на десктопе */
    /* Это правило должно переопределить Tailwind класс hidden */
    .fixed.top-0 nav.hidden,
    .fixed.top-0 nav.hidden.md\:flex {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        height: auto !important;
        width: auto !important;
    }
    
    /* Также убеждаемся, что навигация видна, даже если есть другие классы */
    .fixed.top-0 > .container > div.flex > div:first-child > nav.hidden,
    .fixed.top-0 > .container > div.flex > div:first-child > nav.hidden.md\:flex {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        height: auto !important;
        width: auto !important;
    }
    
    /* Дополнительное правило для гарантии видимости навигации на десктопе */
    /* Это правило переопределяет любое скрытие навигации на десктопе */
    .fixed.top-0 > .container > div.flex > div:first-child > nav {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    /* Еще одно правило с максимальной специфичностью для гарантии */
    .fixed.top-0 > .container > div.flex > div:first-child > nav.hidden.md\:flex.items-center.gap-2 {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    /* Правило для всех ссылок внутри навигации на десктопе */
    .fixed.top-0 > .container > div.flex > div:first-child > nav a {
        display: inline-flex !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
}

/* Улучшаем отображение на очень маленьких экранах */
@media (max-width: 400px) {
    .fixed.top-0 > .container > div.flex {
        gap: 0.25rem !important;
    }
    
    #wallet {
        min-width: 3.5rem !important;
        padding: 0.2rem 0.4rem !important;
    }
    
    #language-switcher-btn {
        min-width: 2.5rem !important;
        padding: 0.4rem !important;
    }
    
    .fixed.top-0 .bg-gray-50.border.border-gray-200.rounded-xl {
        padding: 0.2rem !important;
    }
}

/* Предотвращаем переполнение хедера */
@media (max-width: 640px) {
    .fixed.top-0 > .container {
        overflow: visible !important;
    }
    
    .fixed.top-0 > .container > div.flex {
        flex-wrap: nowrap !important;
        overflow: visible !important;
    }
}

/* Исправляем кнопки в хедере */
.fixed.top-0 button,
.fixed.top-0 a {
    flex-shrink: 0 !important;
}

/* Кнопка администратора - показываем, если класс hidden удален */
#admin-btn:not(.hidden) {
    display: inline-flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    height: auto !important;
    width: auto !important;
    min-height: auto !important;
    min-width: auto !important;
}

/* Убеждаемся, что кнопка администратора видна внутри контейнера */
.fixed.top-0 .bg-gray-50.border.border-gray-200.rounded-xl #admin-btn:not(.hidden),
.fixed.top-0 > .container > div.flex > div:last-child > div > #admin-btn:not(.hidden) {
    display: inline-flex !important;
    visibility: visible !important;
    opacity: 1 !important;
    height: auto !important;
    width: auto !important;
    min-height: auto !important;
    min-width: auto !important;
}

/* Убеждаемся, что кнопка администратора видна на всех разрешениях, если она не скрыта */
@media (min-width: 768px) {
    #admin-btn:not(.hidden),
    .fixed.top-0 .bg-gray-50.border.border-gray-200.rounded-xl #admin-btn:not(.hidden),
    .fixed.top-0 > .container > div.flex > div:last-child > div > #admin-btn:not(.hidden) {
        display: inline-flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        height: auto !important;
        width: auto !important;
    }
}

@media (max-width: 767px) {
    #admin-btn:not(.hidden),
    .fixed.top-0 .bg-gray-50.border.border-gray-200.rounded-xl #admin-btn:not(.hidden),
    .fixed.top-0 > .container > div.flex > div:last-child > div > #admin-btn:not(.hidden) {
        display: inline-flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        height: auto !important;
        width: auto !important;
    }
}

/* Дополнительное правило для гарантии видимости кнопки администратора */
/* Это правило переопределяет любые другие правила, которые могут скрывать кнопку */
.fixed.top-0 button#admin-btn:not(.hidden) {
    display: inline-flex !important;
    visibility: visible !important;
    opacity: 1 !important;
}

/* Исправляем высоту строки в дропдауне */
.language-option {
    line-height: 1.5 !important;
    height: auto !important;
    min-height: 3rem !important;
}

/* Мобильные устройства (до 640px) - дополнительные стили */
@media (max-width: 640px) {
    /* Фиксируем хедер на мобильных - предотвращаем переполнение */
    .fixed.top-0 {
        width: 100% !important;
        max-width: 100vw !important;
        left: 0 !important;
        right: 0 !important;
        box-sizing: border-box !important;
        overflow-x: hidden !important;
    }
    
    .fixed.top-0 > .container {
        width: 100% !important;
        max-width: 100% !important;
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
        box-sizing: border-box !important;
        overflow-x: hidden !important;
    }
    
    .fixed.top-0 > .container > div {
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
        overflow-x: hidden !important;
    }
    
    /* Убеждаемся, что все элементы внутри хедера не выходят за границы */
    .fixed.top-0 * {
        max-width: 100% !important;
        box-sizing: border-box !important;
    }
}

/* Дополнительные стили для мобильных (до 768px) */
@media (max-width: 768px) {
    /* Уменьшаем размер текста для компактности */
    #wallet #balance {
        font-size: 0.875rem !important;
    }
    
    #wallet .text-\\[10px\\] {
        font-size: 0.625rem !important;
    }
    
    .fixed.top-0 #language-switcher-btn,
    .fixed.top-0 #language-switcher-wrapper button {
        padding: 0.375rem !important;
    }
    
    .fixed.top-0 > .container > div > div:last-child {
        padding: 0.25rem 0.375rem !important;
    }
}

/* Планшеты (768px - 1024px) */
@media (min-width: 768px) and (max-width: 1024px) {
    /* Делаем хедер более гибким на планшетах */
    .fixed.top-0 > .container > div.flex.justify-between {
        gap: 0.5rem;
    }
    
    /* Убеждаемся что элементы хедера не сжимаются слишком сильно */
    .fixed.top-0 > .container > div > div:first-child,
    .fixed.top-0 > .container > div > div:last-child {
        flex-shrink: 1;
        min-width: 0;
    }
    
    /* Гарантируем видимость навигации на планшетах */
    .fixed.top-0 nav.hidden,
    .fixed.top-0 nav.hidden.md\:flex {
        display: flex !important;
        visibility: visible !important;
    }
}

/* ФИНАЛЬНОЕ ПРАВИЛО: Гарантируем видимость навигации на всех десктопных разрешениях */
/* Это правило должно быть в самом конце файла для максимального приоритета */
@media (min-width: 768px) {
    /* Переопределяем ВСЕ возможные скрытия навигации на десктопе */
    .fixed.top-0 nav[class*="hidden"],
    .fixed.top-0 > .container > div.flex > div:first-child > nav[class*="hidden"] {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
}
